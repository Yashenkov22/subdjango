{% extends 'admin/change_list.html' %}

{% block pagination %}{% endblock %}
{% block object-tools %}{% endblock object-tools %}
{% block search %}{% endblock %}
{% block filters %}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">Home</a>
  {% if page_name %} &rsaquo; {{ page_name }}{% endif %}
</div>
{% endblock %}

{% block content %}
    <h1 class="text-center my-4">Страница статистики</h1>

    <div class="container">
        <h2>Добавлено товаров за {{ selected_date }}:</h2>
        <ul>
            <li>
                <p>Всего: <strong>{{ wb_count|add:ozon_count }}</strong></p>
            </li>
            <li>
                <p>WB: <strong>{{ wb_count }}</strong></p>
            </li>
            <li>
                <p>Ozon: <strong>{{ ozon_count }}</strong></p>
            </li>
        </ul>

        <h2>Добавлено пользователей за {{ selected_date }}:</h2>
        <ul>
            <li>
                <p>{{ user_count }}</p>
            </li>
        </ul>

        <form method="get" class="mt-4">
            <div class="form-group">
                <label for="start_date">Выберите дату начала:</label><br>
                <input type="date" id="start_date" name="start_date" class="form-control" value="{{ start_date }}">
            </div>
            <div class="form-group">
                <label for="end_date">Выберите дату окончания:</label><br>
                <input type="date" id="end_date" name="end_date" class="form-control" value="{{ end_date }}">
            </div>
            <br>
            <br>
            <button type="submit" class="btn btn-primary">Фильтровать</button>
        </form>
        <br>
        <h2>Популярные города(пункты выдачи):</h2>
        <ol>
            {% for city in popular_cities %}
                <li>{{ city.city }}:  {{ city.city_count }}</li>
            {% endfor %}
        </ol>

        <br>

        <h2>Популярные товары:</h2>
        <ol>
            {% for product in popular_products %}
                <li>
                    <p><a href="http://localhost:8000/admin/products/{{ product.pk }}/change/">{{ product.name }}</a></p>
                    <p>Маркетплейс: {{ product.product_marker|upper }}</p>
                    <p>Кол-во пользователей, отслеживающих товар: <b>{{ product.user_count }}</b></p>
                </li>
            {% endfor %}
        </ol>
    </div>

{% endblock %}